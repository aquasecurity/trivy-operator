package shared

import (
	ostype "github.com/aquasecurity/trivy/pkg/fanal/types"
)

// VulnerabilitySummary is a summary of Vulnerability counts grouped by Severity.
type VulnerabilitySummary struct {
	// CriticalCount is the number of vulnerabilities with Critical Severity.
	// +kubebuilder:validation:Minimum=0
	CriticalCount int `json:"criticalCount"`

	// HighCount is the number of vulnerabilities with High Severity.
	// +kubebuilder:validation:Minimum=0
	HighCount int `json:"highCount"`

	// MediumCount is the number of vulnerabilities with Medium Severity.
	// +kubebuilder:validation:Minimum=0
	MediumCount int `json:"mediumCount"`

	// LowCount is the number of vulnerabilities with Low Severity.
	// +kubebuilder:validation:Minimum=0
	LowCount int `json:"lowCount"`

	// UnknownCount is the number of vulnerabilities with unknown severity.
	// +kubebuilder:validation:Minimum=0
	UnknownCount int `json:"unknownCount"`

	// NoneCount is the number of packages without any vulnerability.
	// +kubebuilder:validation:Minimum=0
	// +optional
	NoneCount int `json:"noneCount"`
}

// Registry is a collection of repositories used to store Artifacts.
type Registry struct {
	// Server the FQDN of registry server.
	// +optional
	Server string `json:"server"`
}

// Artifact represents a standalone, executable package of software that
// includes everything needed to run an application.
type Artifact struct {
	// Repository is the name of the repository in the Artifact registry.
	// +optional
	Repository string `json:"repository"`

	// Digest is a unique and immutable identifier of an Artifact.
	// +optional
	Digest string `json:"digest,omitempty"`

	// Tag is a mutable, human-readable string used to identify an Artifact.
	// +optional
	Tag string `json:"tag,omitempty"`

	// MimeType represents a type and format of an Artifact.
	// +optional
	MimeType string `json:"mimeType,omitempty"`
}

// OS is the Operating System of the Artifact
// +kubebuilder:object:generate=true
type OS struct {
	// Eosl is true if OS version has reached end of service life
	// +optional
	Eosl bool `json:"eosl,omitempty"`

	// Operating System Family
	// +optional
	Family ostype.OSType `json:"family"`

	// Name or version of the OS
	// +optional
	Name string `json:"name,omitempty"`
}
