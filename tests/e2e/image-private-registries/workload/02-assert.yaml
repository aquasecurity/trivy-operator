---
apiVersion: kuttl.dev/v1beta1
commands:
  - script: >
      ttl="$(kubectl get secrets regcred-scan-vulnerabilityreport-9845bdc5f-79lb2 -n trivy-system -o jsonpath='{.metadata.annotations.trivy-operator\.aquasecurity\.github\.io/secret-ttl}')"
      if [ "$ttl" == "0s" ]

      then
        echo "Pass: found matching secret with ttl ($ttl)"
      else
        echo "Fail: not found matching ttl ($ttl) should be greater than 0s"
        exit 1
      fi
kind: TestAssert
timeout: 30
